-- MinimalGUI Library for Roblox Executors
-- Enhanced design with professional styling and improved minimalism

local MinimalGUI = {}
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")

-- Enhanced Design Configuration
local Config = {
    Colors = {
        Background = Color3.fromRGB(16, 16, 20),        -- Deeper, more professional dark
        Secondary = Color3.fromRGB(24, 24, 28),         -- Subtle contrast
        Tertiary = Color3.fromRGB(32, 32, 38),          -- Card backgrounds
        Accent = Color3.fromRGB(99, 102, 241),          -- More sophisticated purple-blue
        AccentHover = Color3.fromRGB(129, 140, 248),    -- Lighter hover state
        Text = Color3.fromRGB(248, 250, 252),           -- Softer white
        TextSecondary = Color3.fromRGB(148, 163, 184),  -- Professional gray
        TextMuted = Color3.fromRGB(100, 116, 139),      -- Subtle text
        Success = Color3.fromRGB(34, 197, 94),          -- Modern green
        Danger = Color3.fromRGB(239, 68, 68),           -- Modern red
        Border = Color3.fromRGB(39, 39, 42),            -- Subtle borders
        Shadow = Color3.fromRGB(0, 0, 0)                -- Pure black for shadows
    },
    Fonts = {
        Regular = Enum.Font.Inter,
        Medium = Enum.Font.InterMedium,
        Bold = Enum.Font.InterBold
    },
    Animations = {
        Speed = 0.25,
        FastSpeed = 0.15,
        SlowSpeed = 0.4,
        Style = Enum.EasingStyle.Cubic,
        Direction = Enum.EasingDirection.Out
    },
    Spacing = {
        Small = 8,
        Medium = 16,
        Large = 24,
        ExtraLarge = 32
    },
    Radius = {
        Small = 6,
        Medium = 10,
        Large = 14,
        ExtraLarge = 18
    }
}

-- Enhanced Utility Functions
local function CreateTween(object, properties, duration, style, direction)
    duration = duration or Config.Animations.Speed
    style = style or Config.Animations.Style
    direction = direction or Config.Animations.Direction
    local tweenInfo = TweenInfo.new(duration, style, direction)
    return TweenService:Create(object, tweenInfo, properties)
end

local function CreateCorner(parent, radius)
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, radius or Config.Radius.Medium)
    corner.Parent = parent
    return corner
end

local function CreateStroke(parent, color, thickness, transparency)
    local stroke = Instance.new("UIStroke")
    stroke.Color = color or Config.Colors.Border
    stroke.Thickness = thickness or 1
    stroke.Transparency = transparency or 0
    stroke.Parent = parent
    return stroke
end

local function CreateShadow(parent, size, transparency)
    local shadow = Instance.new("ImageLabel")
    shadow.Name = "Shadow"
    shadow.Size = UDim2.new(1, size or 20, 1, size or 20)
    shadow.Position = UDim2.new(0, -(size or 20)/2, 0, -(size or 20)/2)
    shadow.BackgroundTransparency = 1
    shadow.Image = "rbxasset://textures/ui/GuiImagePlaceholder.png"
    shadow.ImageColor3 = Config.Colors.Shadow
    shadow.ImageTransparency = transparency or 0.8
    shadow.ZIndex = parent.ZIndex - 1
    shadow.Parent = parent.Parent
    return shadow
end

local function CreatePadding(parent, padding)
    local uiPadding = Instance.new("UIPadding")
    if type(padding) == "number" then
        uiPadding.PaddingTop = UDim.new(0, padding)
        uiPadding.PaddingBottom = UDim.new(0, padding)
        uiPadding.PaddingLeft = UDim.new(0, padding)
        uiPadding.PaddingRight = UDim.new(0, padding)
    elseif type(padding) == "table" then
        uiPadding.PaddingTop = UDim.new(0, padding.Top or 0)
        uiPadding.PaddingBottom = UDim.new(0, padding.Bottom or 0)
        uiPadding.PaddingLeft = UDim.new(0, padding.Left or 0)
        uiPadding.PaddingRight = UDim.new(0, padding.Right or 0)
    end
    uiPadding.Parent = parent
    return uiPadding
end

-- Main GUI Class
function MinimalGUI:CreateWindow(title, size)
    title = title or "MinimalGUI"
    size = size or UDim2.new(0, 640, 0, 480)
    
    local window = {}
    window.Pages = {}
    window.CurrentPage = nil
    
    -- Create ScreenGui
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "MinimalGUI"
    screenGui.Parent = CoreGui
    screenGui.ResetOnSpawn = false
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    
    -- Main Frame with enhanced styling
    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Size = size
    mainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
    mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
    mainFrame.BackgroundColor3 = Config.Colors.Background
    mainFrame.BorderSizePixel = 0
    mainFrame.ZIndex = 10
    mainFrame.Parent = screenGui
    CreateCorner(mainFrame, Config.Radius.ExtraLarge)
    CreateStroke(mainFrame, Config.Colors.Border, 1, 0.5)
    
    -- Professional shadow effect
    CreateShadow(mainFrame, 40, 0.3)
    
    -- Enhanced Title Bar
    local titleBar = Instance.new("Frame")
    titleBar.Name = "TitleBar"
    titleBar.Size = UDim2.new(1, 0, 0, 60)
    titleBar.Position = UDim2.new(0, 0, 0, 0)
    titleBar.BackgroundColor3 = Config.Colors.Secondary
    titleBar.BorderSizePixel = 0
    titleBar.ZIndex = 15
    titleBar.Parent = mainFrame
    CreateCorner(titleBar, Config.Radius.ExtraLarge)
    CreateStroke(titleBar, Config.Colors.Border, 1, 0.3)
    
    -- Title bar gradient overlay
    local titleBarGradient = Instance.new("UIGradient")
    titleBarGradient.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 255, 255)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 255, 255))
    }
    titleBarGradient.Transparency = NumberSequence.new{
        NumberSequenceKeypoint.new(0, 0.98),
        NumberSequenceKeypoint.new(1, 0.95)
    }
    titleBarGradient.Rotation = 90
    titleBarGradient.Parent = titleBar
    
    -- Enhanced Title Label
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Name = "TitleLabel"
    titleLabel.Size = UDim2.new(1, -120, 1, 0)
    titleLabel.Position = UDim2.new(0, Config.Spacing.Large, 0, 0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = title
    titleLabel.TextColor3 = Config.Colors.Text
    titleLabel.TextSize = 18
    titleLabel.Font = Config.Fonts.Bold
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.TextYAlignment = Enum.TextYAlignment.Center
    titleLabel.ZIndex = 20
    titleLabel.Parent = titleBar
    
    -- Professional Close Button
    local closeButton = Instance.new("TextButton")
    closeButton.Name = "CloseButton"
    closeButton.Size = UDim2.new(0, 36, 0, 36)
    closeButton.Position = UDim2.new(1, -48, 0.5, -18)
    closeButton.BackgroundColor3 = Config.Colors.Tertiary
    closeButton.BorderSizePixel = 0
    closeButton.Text = "âœ•"
    closeButton.TextColor3 = Config.Colors.TextSecondary
    closeButton.TextSize = 16
    closeButton.Font = Config.Fonts.Medium
    closeButton.ZIndex = 20
    closeButton.Parent = titleBar
    CreateCorner(closeButton, Config.Radius.Medium)
    CreateStroke(closeButton, Config.Colors.Border, 1, 0.5)
    
    -- Enhanced Close Button Animations
    closeButton.MouseEnter:Connect(function()
        CreateTween(closeButton, {
            BackgroundColor3 = Config.Colors.Danger,
            TextColor3 = Config.Colors.Text
        }, Config.Animations.FastSpeed):Play()
    end)
    
    closeButton.MouseLeave:Connect(function()
        CreateTween(closeButton, {
            BackgroundColor3 = Config.Colors.Tertiary,
            TextColor3 = Config.Colors.TextSecondary
        }, Config.Animations.FastSpeed):Play()
    end)
    
    closeButton.MouseButton1Click:Connect(function()
        CreateTween(closeButton, {Size = UDim2.new(0, 32, 0, 32)}, 0.1):Play()
        CreateTween(mainFrame, {
            Size = UDim2.new(0, 0, 0, 0),
            BackgroundTransparency = 1
        }, Config.Animations.Speed):Play()
        wait(Config.Animations.Speed)
        screenGui:Destroy()
    end)
    
    -- Enhanced Content Frame
    local contentFrame = Instance.new("Frame")
    contentFrame.Name = "ContentFrame"
    contentFrame.Size = UDim2.new(1, -Config.Spacing.ExtraLarge, 1, -84)
    contentFrame.Position = UDim2.new(0, Config.Spacing.Medium, 0, 76)
    contentFrame.BackgroundTransparency = 1
    contentFrame.ZIndex = 15
    contentFrame.Parent = mainFrame
    
    -- Enhanced Page Navigation
    local pageList = Instance.new("Frame")
    pageList.Name = "PageList"
    pageList.Size = UDim2.new(0, 160, 1, 0)
    pageList.Position = UDim2.new(0, 0, 0, 0)
    pageList.BackgroundTransparency = 1
    pageList.ZIndex = 15
    pageList.Parent = contentFrame
    
    local pageListLayout = Instance.new("UIListLayout")
    pageListLayout.SortOrder = Enum.SortOrder.LayoutOrder
    pageListLayout.Padding = UDim.new(0, Config.Spacing.Small)
    pageListLayout.Parent = pageList
    
    CreatePadding(pageList, {Top = Config.Spacing.Small})
    
    -- Enhanced Page Content
    local pageContent = Instance.new("Frame")
    pageContent.Name = "PageContent"
    pageContent.Size = UDim2.new(1, -180, 1, 0)
    pageContent.Position = UDim2.new(0, 180, 0, 0)
    pageContent.BackgroundColor3 = Config.Colors.Secondary
    pageContent.BorderSizePixel = 0
    pageContent.ZIndex = 15
    pageContent.Parent = contentFrame
    CreateCorner(pageContent, Config.Radius.Large)
    CreateStroke(pageContent, Config.Colors.Border, 1, 0.5)
    
    -- Drag Functionality (Enhanced)
    local dragging = false
    local dragStart = nil
    local startPos = nil
    
    titleBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = mainFrame.Position
            CreateTween(mainFrame, {BackgroundColor3 = Config.Colors.Tertiary}, Config.Animations.FastSpeed):Play()
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement and dragging then
            local delta = input.Position - dragStart
            mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
            CreateTween(mainFrame, {BackgroundColor3 = Config.Colors.Background}, Config.Animations.FastSpeed):Play()
        end
    end)
    
    -- Window Methods
    function window:CreatePage(name)
        local page = {}
        page.Name = name
        page.Elements = {}
        
        -- Enhanced Page Button
        local pageButton = Instance.new("TextButton")
        pageButton.Name = name .. "Button"
        pageButton.Size = UDim2.new(1, 0, 0, 44)
        pageButton.BackgroundColor3 = Config.Colors.Tertiary
        pageButton.BackgroundTransparency = 0.8
        pageButton.BorderSizePixel = 0
        pageButton.Text = name
        pageButton.TextColor3 = Config.Colors.TextSecondary
        pageButton.TextSize = 14
        pageButton.Font = Config.Fonts.Medium
        pageButton.ZIndex = 20
        pageButton.Parent = pageList
        CreateCorner(pageButton, Config.Radius.Medium)
        CreateStroke(pageButton, Config.Colors.Border, 1, 0.7)
        CreatePadding(pageButton, Config.Spacing.Medium)
        
        -- Enhanced Page Frame
        local pageFrame = Instance.new("ScrollingFrame")
        pageFrame.Name = name .. "Frame"
        pageFrame.Size = UDim2.new(1, 0, 1, 0)
        pageFrame.Position = UDim2.new(0, 0, 0, 0)
        pageFrame.BackgroundTransparency = 1
        pageFrame.BorderSizePixel = 0
        pageFrame.ScrollBarThickness = 6
        pageFrame.ScrollBarImageColor3 = Config.Colors.Accent
        pageFrame.ScrollBarImageTransparency = 0.3
        pageFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
        pageFrame.Visible = false
        pageFrame.ZIndex = 20
        pageFrame.Parent = pageContent
        
        local pageLayout = Instance.new("UIListLayout")
        pageLayout.SortOrder = Enum.SortOrder.LayoutOrder
        pageLayout.Padding = UDim.new(0, Config.Spacing.Medium)
        pageLayout.Parent = pageFrame
        
        CreatePadding(pageFrame, Config.Spacing.Large)
        
        -- Auto-resize canvas
        pageLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            pageFrame.CanvasSize = UDim2.new(0, 0, 0, pageLayout.AbsoluteContentSize.Y + Config.Spacing.ExtraLarge * 2)
        end)
        
        -- Enhanced Page Button Click
        pageButton.MouseButton1Click:Connect(function()
            for _, p in pairs(window.Pages) do
                p.Frame.Visible = false
                CreateTween(p.Button, {
                    BackgroundTransparency = 0.8,
                    TextColor3 = Config.Colors.TextSecondary
                }, Config.Animations.FastSpeed):Play()
            end
            pageFrame.Visible = true
            CreateTween(pageButton, {
                BackgroundTransparency = 0,
                TextColor3 = Config.Colors.Text
            }, Config.Animations.FastSpeed):Play()
            window.CurrentPage = page
        end)
        
        -- Enhanced Page Button Hover
        pageButton.MouseEnter:Connect(function()
            if window.CurrentPage ~= page then
                CreateTween(pageButton, {BackgroundTransparency = 0.4}, Config.Animations.FastSpeed):Play()
            end
        end)
        
        pageButton.MouseLeave:Connect(function()
            if window.CurrentPage ~= page then
                CreateTween(pageButton, {BackgroundTransparency = 0.8}, Config.Animations.FastSpeed):Play()
            end
        end)
        
        page.Button = pageButton
        page.Frame = pageFrame
        
        -- Enhanced Page Methods
        function page:CreateButton(text, callback)
            local button = Instance.new("TextButton")
            button.Name = text .. "Button"
            button.Size = UDim2.new(1, 0, 0, 48)
            button.BackgroundColor3 = Config.Colors.Accent
            button.BorderSizePixel = 0
            button.Text = text
            button.TextColor3 = Config.Colors.Text
            button.TextSize = 14
            button.Font = Config.Fonts.Medium
            button.ZIndex = 25
            button.Parent = pageFrame
            CreateCorner(button, Config.Radius.Medium)
            CreateStroke(button, Config.Colors.Accent, 1, 0.5)
            CreatePadding(button, Config.Spacing.Medium)
            
            -- Enhanced button hover effects
            button.MouseEnter:Connect(function()
                CreateTween(button, {
                    BackgroundColor3 = Config.Colors.AccentHover,
                    Size = UDim2.new(1, 0, 0, 50)
                }, Config.Animations.FastSpeed):Play()
            end)
            
            button.MouseLeave:Connect(function()
                CreateTween(button, {
                    BackgroundColor3 = Config.Colors.Accent,
                    Size = UDim2.new(1, 0, 0, 48)
                }, Config.Animations.FastSpeed):Play()
            end)
            
            button.MouseButton1Click:Connect(function()
                CreateTween(button, {BackgroundColor3 = Config.Colors.Tertiary}, 0.1):Play()
                wait(0.1)
                CreateTween(button, {BackgroundColor3 = Config.Colors.Accent}, 0.1):Play()
                if callback then callback() end
            end)
            
            table.insert(page.Elements, button)
            return button
        end
        
        function page:CreateToggle(text, defaultValue, callback)
            defaultValue = defaultValue or false
            local toggleValue = defaultValue
            
            local toggleFrame = Instance.new("Frame")
            toggleFrame.Name = text .. "Toggle"
            toggleFrame.Size = UDim2.new(1, 0, 0, 52)
            toggleFrame.BackgroundColor3 = Config.Colors.Tertiary
            toggleFrame.BorderSizePixel = 0
            toggleFrame.ZIndex = 25
            toggleFrame.Parent = pageFrame
            CreateCorner(toggleFrame, Config.Radius.Medium)
            CreateStroke(toggleFrame, Config.Colors.Border, 1, 0.5)
            CreatePadding(toggleFrame, Config.Spacing.Medium)
            
            local toggleLabel = Instance.new("TextLabel")
            toggleLabel.Size = UDim2.new(1, -80, 1, 0)
            toggleLabel.Position = UDim2.new(0, 0, 0, 0)
            toggleLabel.BackgroundTransparency = 1
            toggleLabel.Text = text
            toggleLabel.TextColor3 = Config.Colors.Text
            toggleLabel.TextSize = 14
            toggleLabel.Font = Config.Fonts.Medium
            toggleLabel.TextXAlignment = Enum.TextXAlignment.Left
            toggleLabel.TextYAlignment = Enum.TextYAlignment.Center
            toggleLabel.ZIndex = 30
            toggleLabel.Parent = toggleFrame
            
            local toggleButton = Instance.new("TextButton")
            toggleButton.Size = UDim2.new(0, 56, 0, 28)
            toggleButton.Position = UDim2.new(1, -56, 0.5, -14)
            toggleButton.BackgroundColor3 = toggleValue and Config.Colors.Success or Config.Colors.Border
            toggleButton.BorderSizePixel = 0
            toggleButton.Text = ""
            toggleButton.ZIndex = 30
            toggleButton.Parent = toggleFrame
            CreateCorner(toggleButton, 14)
            
            local toggleIndicator = Instance.new("Frame")
            toggleIndicator.Size = UDim2.new(0, 22, 0, 22)
            toggleIndicator.Position = toggleValue and UDim2.new(1, -25, 0.5, -11) or UDim2.new(0, 3, 0.5, -11)
            toggleIndicator.BackgroundColor3 = Config.Colors.Text
            toggleIndicator.BorderSizePixel = 0
            toggleIndicator.ZIndex = 35
            toggleIndicator.Parent = toggleButton
            CreateCorner(toggleIndicator, 11)
            
            -- Enhanced toggle animation
            toggleButton.MouseButton1Click:Connect(function()
                toggleValue = not toggleValue
                CreateTween(toggleButton, {
                    BackgroundColor3 = toggleValue and Config.Colors.Success or Config.Colors.Border
                }, Config.Animations.FastSpeed):Play()
                CreateTween(toggleIndicator, {
                    Position = toggleValue and UDim2.new(1, -25, 0.5, -11) or UDim2.new(0, 3, 0.5, -11)
                }, Config.Animations.Speed, Enum.EasingStyle.Back):Play()
                if callback then callback(toggleValue) end
            end)
            
            -- Toggle hover effect
            toggleButton.MouseEnter:Connect(function()
                CreateTween(toggleButton, {Size = UDim2.new(0, 58, 0, 30)}, Config.Animations.FastSpeed):Play()
            end)
            
            toggleButton.MouseLeave:Connect(function()
                CreateTween(toggleButton, {Size = UDim2.new(0, 56, 0, 28)}, Config.Animations.FastSpeed):Play()
            end)
            
            table.insert(page.Elements, toggleFrame)
            return toggleFrame, function() return toggleValue end
        end
        
        window.Pages[name] = page
        
        -- Auto-select first page
        if next(window.Pages) and not window.CurrentPage then
            pageButton.MouseButton1Click:Connect(function() end)()
        end
        
        return page
    end
    
    function window:Destroy()
        CreateTween(mainFrame, {
            Size = UDim2.new(0, 0, 0, 0),
            BackgroundTransparency = 1
        }, Config.Animations.Speed):Play()
        wait(Config.Animations.Speed)
        screenGui:Destroy()
    end
    
    -- Enhanced initial animations
    mainFrame.Size = UDim2.new(0, 0, 0, 0)
    mainFrame.BackgroundTransparency = 1
    CreateTween(mainFrame, {
        Size = size,
        BackgroundTransparency = 0
    }, Config.Animations.SlowSpeed, Enum.EasingStyle.Back):Play()
    
    return window
end

return MinimalGUI
